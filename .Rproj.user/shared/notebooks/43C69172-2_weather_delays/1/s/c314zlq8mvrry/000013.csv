"0","disrupted_plot <- ewr_disruptions %>% "
"0","  filter(disrupted_flag == 1) %>% "
"0","  mutate(date = date(time_hour)) %>% "
"0","  group_by(date) %>% "
"0","  summarise(num_flights = n()) %>% "
"0","  mutate("
"0","    num_delayed_moving_avg = slider::slide_dbl("
"0","      .x = num_flights, "
"0","      .f = ~mean(.x, na.rm = TRUE), "
"0","      .before = 2,"
"0","      .after = 2"
"0","    ))"
"0",""
"0","weather_event_disrupted_plot <- weather_events %>% "
"0","  left_join(disrupted_plot, by = ""date"")"
"0",""
"0","# flights_per_day <- ewr_disruptions %>% "
"0","#   mutate(date = date(time_hour)) %>% "
"0","#   group_by(date) %>% "
"0","#   summarise(num_flights = n()) %>% "
"0","#   mutate("
"0","#     num_flights_moving_avg = slider::slide_dbl("
"0","#       .x = num_flights, "
"0","#       .f = ~mean(.x, na.rm = TRUE), "
"0","#       .before = 2,"
"0","#       .after = 2"
"0","#     ))"
"0",""
"0","ggplot() +"
"0","  geom_line(data = disrupted_plot, aes(x = date, y = num_flights), alpha = 0.3, colour = ""#2c7fb8"") +"
"0","  geom_line(data = disrupted_plot, aes(x = date, y = num_delayed_moving_avg), alpha = 1, linewidth = 0.7) +"
"0","  #geom_line(data = flights_per_day, aes(x = date, y = num_flights_moving_avg), alpha = 1, linewidth = 0.7) +"
"0","  #geom_point(data = weather_event_disrupted_plot, aes(x = date, y = num_flights), colour = ""red"") +"
"0","  geom_point(data = weather_event_disrupted_plot %>% slice_max(num_flights, n = 5),"
"0","             aes(x = date, y = num_flights), colour = ""red"") +"
"0","  geom_point(data = weather_event_disrupted_plot %>% slice_min(num_flights, n = 5),"
"0","             aes(x = date, y = num_flights), colour = ""red"") +"
"0","  ggtext::geom_richtext("
"0","    data = weather_event_disrupted_plot %>% slice_max(num_flights, n = 5),"
"0","    aes(x = date, y = 260, label = event),"
"0","    angle = 90, size = 3, fill = ""#253494"", colour = ""white"") +"
"0","  ggtext::geom_richtext("
"0","    data = weather_event_disrupted_plot %>% slice_min(num_flights, n = 5),"
"0","    aes(x = date, y = 170, label = event),"
"0","    angle = 90, size = 3, fill = ""#41b6c4"", colour = ""white"") +"
"0","  labs(title = ""Departure Disruption at Newark Airport in 2017"","
"0","       subtitle = ""With 5-day Rolling Average and Selected Severe Weather Events"","
"0","       x = """","
"0","       y = ""Number of Flights\n"") +"
"0","  scale_y_continuous(limits = c(15, 335), breaks = seq(0, 350, 50), minor_breaks = NULL) +"
"0","  theme_minimal()"
