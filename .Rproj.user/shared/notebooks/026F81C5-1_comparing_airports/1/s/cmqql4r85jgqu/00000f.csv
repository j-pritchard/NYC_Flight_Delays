"0","after3pm_delay <- departures %>% "
"0","  filter(dep_delay <= (mean(dep_delay) + 5*sd(dep_delay)), # removing outliers"
"0","         sched_dep_time >= 1500) %>% # only after 3pm"
"0","  group_by(origin) %>%"
"0","  summarise(after_3pm_mean_delay = round(mean(dep_delay), 1))"
"0",""
"0","winter_delay <- departures %>% "
"0","  mutate(month = month(time_hour)) %>%"
"0","  filter(dep_delay <= (mean(dep_delay) + 5*sd(dep_delay)), # removing outliers"
"0","         month %in% c(11, 12, 1, 2)) %>% # only Nov - Feb"
"0","  group_by(origin) %>%"
"0","  summarise(winter_mean_delay = round(mean(dep_delay), 1))"
"0",""
"0","winter_after_3pm_delay <- departures %>% "
"0","  mutate(month = month(time_hour)) %>%"
"0","  filter(dep_delay <= (mean(dep_delay) + 5*sd(dep_delay)), # removing outliers"
"0","         month %in% c(11, 12, 1, 2), # only Nov - Feb"
"0","         sched_dep_time >= 1500) %>% # only after 3pm"
"0","  group_by(origin) %>%"
"0","  summarise(winter_after_3pm_mean_delay = round(mean(dep_delay), 1))"
"0",""
"0","after3pm_delay %>% "
"0","  left_join(winter_delay, by = ""origin"") %>% "
"0","  left_join(winter_after_3pm_delay, by = ""origin"") %>% "
"0","  pivot_longer(cols = c(after_3pm_mean_delay, winter_mean_delay, winter_after_3pm_mean_delay)) %>% "
"0","  ggplot(aes(x = factor(name,"
"0","                        levels = c(""after_3pm_mean_delay"", ""winter_mean_delay"", ""winter_after_3pm_mean_delay""), "
"0","                        labels = c(""After 3pm"", ""Winter"", ""Winter after 3pm"")),"
"0","             y = value,"
"0","             fill = origin)) +"
"0","  geom_col(position = ""dodge"", colour = ""white"") +"
"0","  geom_text(aes(label = value),"
"0","            vjust = 1.5,"
"0","            colour = ""white"","
"0","            position = position_dodge(width = 0.9)) +"
"0","  labs(x = ""\nTime of day / Time of year"","
"0","       y = ""Mean Delay (minutes)\n"","
"0","       title = ""Worst Performing Times for Newark Airport"") +"
"0","  scale_y_continuous(breaks = seq(0, 28, 4)) +"
"0","  scale_fill_manual(name = ""Airport"","
"0","                    labels = c(""Newark"", ""JFK"", ""LaGuardia""),"
"0","                    values = x3colours) +"
"0","  theme_minimal()"
