"0","flights <- read_csv(""../clean_data/all_flight_data.csv"") %>% "
"0","  mutate(hour = hour(time_hour), .before = sched_dep_time)  "
"0",""
"0","bad_days <- flights %>% "
"0","  filter(disrupted_flag == TRUE) %>%"
"0","  group_by(date) %>% "
"0","  summarise(count = n()) %>% "
"0","  filter(count > (mean(count) + 2 * sd(count))) %>% "
"0","  pull(date)"
"0",""
"0","bad_days_flights <- flights %>% "
"0","  filter(origin == ""EWR"","
"0","         date %in% bad_days)"
"0",""
"0","good_days_flights <- flights %>% "
"0","  filter(origin == ""EWR"","
"0","         !date %in% bad_days)"
"0",""
"0","bad_days_logreg_model <- glm(disrupted_flag ~"
"0","                               hour + temp + dewpoint + humidity + precip +"
"0","                               pressure + wind_speed + wind_dir + visib + snow +"
"0","                               carrier,"
"0","                             data = bad_days_flights,"
"0","                             family = binomial(link = 'logit'))"
"0",""
"0","bad_days_with_all_pred <- bad_days_flights %>%"
"0","  add_predictions(bad_days_logreg_model, type = ""response"")"
"0",""
"0","library(pROC)"
"0","roc_obj_all_pred <- bad_days_with_all_pred %>%"
"0","  roc(response = disrupted_flag, predictor = pred)"
"0",""
"0","roc_curve <- ggroc(data = roc_obj_all_pred, legacy.axes = TRUE) +"
"0","  coord_fixed() + "
"0","  ylab(""sensitivity (TPR)"") + "
"0","  xlab(""1-specificity (TNR)"")"
"0",""
"0","roc_curve"
